<form
  fudisGrid
  [id]="id"
  [attr.aria-describedby]="id + '-header'"
  [width]="width"
  [align]="align"
  [serviceDefaults]="false"
  [alignItemsX]="alignItemsX"
  [alignItemsY]="alignItemsY"
  [classes]="_dialogParent ? 'fudis-form fudis-form__dialog' : 'fudis-form fudis-form__default'"
  [columnGap]="columnGap"
  [rowGap]="'none'"
>
  <div [id]="id + '-header'" class="fudis-form__header">
    <div class="fudis-form__header__main">
      <div class="fudis-form__header__title">
        @if (_dialogParent) {
          <fudis-heading
            class="fudis-form__header__title__dialog fudis-mb-xs"
            fudisDialogTitle
            [variant]="titleVariant"
            [level]="level"
            >{{ title }}
            @if (badge && badgeText) {
              <fudis-badge
                class="fudis-form__header__title__badge"
                [variant]="badge"
                [content]="badgeText"
              />
            }
          </fudis-heading>
        }
        @if (!_dialogParent) {
          <fudis-heading class="fudis-mb-xs" [variant]="titleVariant" [level]="level"
            >{{ title }}
            @if (badge && badgeText) {
              <fudis-badge
                class="fudis-form__header__title__badge"
                [variant]="badge"
                [content]="badgeText"
              />
            }
          </fudis-heading>
        }
        @if (helpText) {
          <fudis-body-text class="fudis-mb-xs">{{ helpText }}</fudis-body-text>
        }
      </div>
      <ng-content select="fudis-form-header" />
      @if (!_dialogParent) {
        <ng-container *ngTemplateOutlet="errorSummary" />
      }
    </div>
  </div>
  @if (!_dialogParent) {
    <ng-container *ngTemplateOutlet="actions" />
  }
  <div class="fudis-form__content-wrapper">
    @if (_dialogParent) {
      <ng-container *ngTemplateOutlet="errorSummary" />
    }
    <ng-content select="fudis-form-content"></ng-content>
  </div>
  @if (_dialogParent) {
    <ng-container *ngTemplateOutlet="actions" />
  }
</form>

<ng-template #errorSummary>
  @if (_elementRef.nativeElement && (errorSummaryVisible || _errorSummaryVisibleSignal())) {
    <fudis-error-summary
      [formId]="id"
      (handleUpdatedErrorList)="handleUpdatedErrorList.emit($event)"
      [parentComponent]="_elementRef.nativeElement"
      [title]="errorSummaryTitle"
    />
  }
</ng-template>

<ng-template #actions>
  <ng-content select="fudis-form-actions" />
</ng-template>
