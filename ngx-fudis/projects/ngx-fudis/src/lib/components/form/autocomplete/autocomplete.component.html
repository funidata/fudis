<div class="fudis-autocomplete fudis-autocomplete__{{ size }}">
	<fudis-label
		[text]="label"
		[id]="id + '__label'"
		[for]="id"
		[requiredText]="requiredText"
		[tooltip]="tooltip"
		[tooltipPosition]="tooltipPosition"
		[tooltipToggle]="tooltipToggle">
	</fudis-label>
	<div class="fudis-autocomplete__input-wrapper">
		<input
			[attr.aria-invalid]="control.invalid || invalidState"
			#fudisAutocompleteInput
			class="fudis-autocomplete__input"
			[id]="id"
			[class.fudis-autocomplete__input--invalid]="(control.invalid && control.touched) || invalidState"
			[class.fudis-autocomplete__input--disabled]="disabled"
			type="text"
			[formControl]="control"
			[matAutocomplete]="autocomplete"
			[attr.aria-describedby]="id + '_guidance'"
			[readonly]="disabled"
			[attr.aria-disabled]="disabled"
			[attr.required]="requiredText" />
		<ng-container *ngIf="control.value">
			<fudis-button
				class="fudis-autocomplete__input__icon"
				[size]="'icon-only'"
				[variant]="'tertiary'"
				[icon]="'close'"
				(handleClick)="clearFilter()"
				[label]="clearFilterText"
				[labelHidden]="true">
			</fudis-button>
		</ng-container>
		<ng-container *ngIf="!control.value || control.value === ''">
			<fudis-icon
				class="fudis-autocomplete__input__icon"
				[icon]="'search'"
				[class.fudis-autocomplete__input__icon--disabled]="disabled">
			</fudis-icon>
		</ng-container>
	</div>
	<fudis-guidance [inputLabel]="label" [helpText]="helpText" [for]="id" [errorMsg]="errorMsg" [control]="control">
	</fudis-guidance>

	<mat-autocomplete
		class="fudis-autocomplete__option-list"
		#autocomplete="matAutocomplete"
		autoActiveFirstOption
		[displayWith]="displayFn">
		<mat-option
			class="fudis-autocomplete__option"
			*ngFor="let option of filteredOptions | async"
			[value]="option"
			[disabled]="option.disabled">
			{{ option.viewValue }}
		</mat-option>
	</mat-autocomplete>
</div>
