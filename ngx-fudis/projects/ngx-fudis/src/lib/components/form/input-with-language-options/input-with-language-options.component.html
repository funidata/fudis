<div class="fudis-input-with-language-options fudis-input-size__{{ size }}">
  <div class="fudis-input-with-language-options__inputs">
    <fudis-label
      [for]="id"
      [text]="label"
      [id]="id + '-label'"
      [required]="_required"
      [tooltip]="tooltip"
      [tooltipPosition]="tooltipPosition"
      [tooltipToggle]="tooltipToggle"
    />
    <ng-container *ngFor="let control of formGroup.controls | keyvalue; let index = index">
      <input
        *ngIf="variant === 'text-input' && control.key === _selectControl.value.value"
        #inputRef
        class="fudis-form-input fudis-input-with-language-options__inputs__text"
        [attr.aria-invalid]="
          (formGroup.controls[control.key].touched && formGroup.controls[control.key].invalid) ||
          (formGroup.controls[control.key].touched && invalidState)
            ? true
            : null
        "
        [attr.aria-label]="label + ', ' + _selectControl.value.label"
        [attr.minlength]="_minLength"
        [attr.maxlength]="_maxLength"
        [formControl]="formGroup.controls[control.key]"
        (keyup)="_updateSelectOptions(); handleKeyUp.emit($event)"
        (blur)="handleBlur.emit($event)"
        [id]="id"
        [attr.aria-describedby]="id + '_guidance'"
        [attr.required]="_required ? true : null"
        [attr.aria-disabled]="formGroup.controls[control.key].disabled || disabled"
        [readonly]="formGroup.controls[control.key].disabled || disabled"
      />
      <textarea
        #inputRef
        *ngIf="variant === 'text-area' && control.key === _selectControl.value.value"
        class="fudis-form-input fudis-input-with-language-options__inputs__area"
        [attr.aria-invalid]="
          (formGroup.controls[control.key].touched && formGroup.controls[control.key].invalid) ||
          (formGroup.controls[control.key].touched && invalidState)
            ? true
            : null
        "
        [attr.aria-label]="label + ', ' + _selectControl.value.label"
        [attr.minlength]="_minLength"
        [attr.maxlength]="_maxLength"
        [formControl]="formGroup.controls[control.key]"
        (keyup)="_updateSelectOptions(); handleKeyUp.emit($event)"
        (blur)="handleBlur.emit($event)"
        [id]="id"
        [attr.aria-describedby]="id + '_guidance'"
        [attr.required]="_required ? true : null"
        [attr.aria-disabled]="formGroup.controls[control.key].disabled || disabled"
        [readonly]="formGroup.controls[control.key].disabled || disabled"
      >
      </textarea>
    </ng-container>
    <fudis-guidance
      *ngIf="!disableGuidance"
      [inputLabel]="label"
      [reloadErrorSummary]="_reloadErrorSummary"
      [maxLength]="_maxLength"
      [helpText]="helpText"
      [formGroup]="formGroup"
      [for]="id"
      [selectedOption]="_selectControl.value.value"
    />
  </div>
  <fudis-select
    *ngIf="_languageLabel | async as label"
    class="fudis-input-with-language-options__select"
    [label]="label"
    (selectionUpdate)="_checkHtmlAttributes($event?.value)"
    [control]="_selectControl"
    [size]="'xs'"
    [id]="id + '_language-select'"
  >
    <ng-template fudisContent type="select-options">
      <fudis-select-option
        *ngFor="let option of _selectOptions"
        [data]="{ value: option.value, label: option.label, disabled: option.disabled }"
      />
    </ng-template>
  </fudis-select>
</div>
