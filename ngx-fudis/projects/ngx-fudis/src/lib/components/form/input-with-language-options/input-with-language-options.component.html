<div class="fudis-input-with-language-options fudis-input-with-language-options__{{ size }}">
	<div class="fudis-input-with-language-options__inputs">
		<ng-container *ngIf="formGroup.controls">
			<ng-container *ngTemplateOutlet="variant === 'text-area' ? textArea : textInput"></ng-container>
			<fudis-guidance
				[inputLabel]="label"
				[groupErrorMsg]="groupErrorMsg"
				[helpText]="helpText"
				[formGroup]="formGroup"
				[for]="id">
			</fudis-guidance>
		</ng-container>
	</div>
	<fudis-dropdown
		[hideSingleSelectionIndicator]="true"
		class="fudis-input-with-language-options__dropdown"
		(selectionUpdate)="handleLanguageSelect($event)"
		[control]="dropdownControl"
		[label]="'Language'"
		[size]="missingLanguage ? 'xs' : 'l'"
		[id]="id + '_language-dropdown'"
		[options]="updatedOptions">
	</fudis-dropdown>
</div>

<ng-template #textInput>
	<ng-container *ngFor="let control of formGroup.controls | keyvalue; let index = index">
		<fudis-text-input
			*ngIf="control.key === dropdownControl.value.value"
			(handleBlur)="handleInputBlur($event, control.key)"
			class="fudis-input-with-language-options__inputs__item"
			[ariaLabel]="label + ', ' + dropdownControl.value.viewValue"
			[size]="'l'"
			[label]="label"
			[id]="id"
			[requiredText]="requiredControls[control.key].requiredText"
			[invalidState]="formGroup.invalid && formGroup.touched"
			[control]="$any(formGroup).controls[control.key]"></fudis-text-input>
	</ng-container>
</ng-template>

<ng-template #textArea>
	<ng-container *ngFor="let control of formGroup.controls | keyvalue; let index = index">
		<fudis-text-area
			*ngIf="control.key === dropdownControl.value.value"
			(handleBlur)="handleInputBlur($event, control.key)"
			class="fudis-input-with-language-options__inputs__item"
			[ariaLabel]="label + ', ' + dropdownControl.value.viewValue"
			[size]="'l'"
			[label]="label"
			[id]="id"
			[invalidState]="formGroup.invalid && formGroup.touched"
			[requiredText]="requiredControls[control.key].requiredText"
			[control]="$any(formGroup).controls[control.key]"></fudis-text-area>
	</ng-container>
</ng-template>
