import { ArgTypes, Meta, Canvas } from "@storybook/blocks";
import * as ErrorMessageStories from "./error-message.stories";
import { ErrorMessageComponent } from "./error-message.component";

<Meta title="Components/Form/Error Message" />

# Error Message

Form component's errors can be achieved in two ways:

- Through form control's validators: [Fudis Validators](/docs/utilities-validators--documentation).
- As an Error Message child component, for cases when using a validator or creating a custom one can be tricky.

If your error message repeats multiple times across your form or application, it is recommended to create your own [Fudis Validator](/docs/utilities-validators--documentation).

This page is documentation for the latter Error Message Component, which binds custom error message to Fudis Form components through content projection.

This requires the use of selector `fudis-error-message`. Both Error Message and Fudis Validator errors create the same UI result and renders errors under the Guidance Component.

## Usage Guidelines

### Mandatory Properties

The mandatory property for Error Message is `message`. Visibility of the error is handled by Angular `*ngIf` directive.

When `*ngIf` is true, it will adjust the parent's form control by binding a custom validator to it. This will trigger creation of `FudisValidatorErrorMessage` instance, which also sends error data to the Error Summary. If `*ngIf` is set to false again, this will remove the added validator and also remove error from Error Summary.

Message parameter can be passed either as a string or as an observable string.

```
<fudis-text-input
	[control]="control"
	[label]="'Required text input'">
	<fudis-error-message
		*ngIf="errorExistsCondition"
		[message]="'This is a custom error message which has been added with content projection'"
		 />
</fudis-text-input>
```

## Example

The following example demostrates how custom error message can be used along with Fudis Validator error messages. By toggling 'Switch Message Content' button will dynamically update error message content.

<Canvas of={ErrorMessageStories.Example}></Canvas>

## Accessibility

- Related form field label and id are linked to error message
- Error Message is correctly passed to [Error Summary](/docs/components-form-error-summary--documentation)

## Currently Supported Form Components

- [Text Input](/docs/components-form-text-input--documentation)
- [Text Area](/docs/components-form-text-area--documentation)
- [Select](/docs/components-form-select--documentation)
- [Checkbox Group](/docs/components-form-checkbox-group--documentation)
- [Date Picker](/docs/components-form-date-datepicker--documentation)
- [Radio Button Group](/docs/components-form-radio-button-group--documentation)
- [Localized Text Group](/docs/components-form-localized-text-group--documentation)

## Related Components

- [Error Summary](/docs/components-form-error-summary--documentation)

<ArgTypes of={ErrorMessageComponent} />
````
