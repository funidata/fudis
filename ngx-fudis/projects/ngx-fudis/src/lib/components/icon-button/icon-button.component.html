<ng-container *ngIf="popoverText">
  <button
    fudisPopover
    #buttonElement
    [class]="_classList | async"
    type="button"
    (click)="!disabled && buttonClick($event)"
    (blur)="!disabled && _handleButtonBlur($event)"
    (focus)="!disabled && _handleButtonFocus($event)"
    (keydown)="!disabled && _handleMenuButtonKeyDown($event)"
    [attr.tabIndex]="disabled ? -1 : null"
    [attr.aria-disabled]="disabled || null"
    [attr.aria-label]="ariaLabel"
    [attr.id]="id"
    [popoverPosition]="popoverPosition"
    [popoverText]="popoverText"
  >
    <ng-container *ngIf="icon">
      <div [class]="_iconMargin | async">
        <fudis-icon
          *ngIf="_iconColor | async as iconColor"
          class="fudis-button__icon__component"
          [color]="iconColor"
          [icon]="icon"
          [rotate]="iconRotate"
        ></fudis-icon>
      </div>
    </ng-container>
  </button>
</ng-container>

<ng-container *ngIf="!popoverText">
  <button
    #buttonElement
    [class]="_classList | async"
    type="button"
    (click)="!disabled && buttonClick($event)"
    (blur)="!disabled && _handleButtonBlur($event)"
    (focus)="!disabled && _handleButtonFocus($event)"
    (keydown)="!disabled && _handleMenuButtonKeyDown($event)"
    [attr.tabIndex]="disabled ? -1 : null"
    [attr.aria-disabled]="disabled || null"
    [attr.aria-label]="ariaLabel"
    [attr.id]="id"
    [attr.aria-expanded]="!asMenuButton ? null : (dropdownOpen | async)"
    [attr.aria-haspopup]="!asMenuButton ? null : 'menu'"
  >
    <ng-container *ngIf="icon">
      <div [class]="_iconMargin | async">
        <fudis-icon
          *ngIf="_iconColor | async as iconColor"
          class="fudis-button__icon__component"
          [color]="iconColor"
          [icon]="icon"
          [rotate]="iconRotate"
        ></fudis-icon>
      </div> </ng-container
  ></button>
</ng-container>

<ng-container *ngIf="asMenuButton && (dropdownOpen | async)">
  <ng-content></ng-content>
</ng-container>
